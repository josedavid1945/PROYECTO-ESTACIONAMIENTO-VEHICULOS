<section class="container mx-auto px-8 py-12 min-h-screen">
  
  <!-- ==================== MENÚ PRINCIPAL ==================== -->
  @if (vistaActiva() === 'menu') {
    <app-menu-registro 
      (opcionSeleccionada)="irAVista($event)">
    </app-menu-registro>
  }

  <!-- ==================== VISTA: NUEVO CLIENTE ==================== -->
  @if (vistaActiva() === 'nuevo-cliente') {
    <div class="max-w-4xl mx-auto">
      <!-- Header -->
      <div class="flex items-center mb-8">
        <button (click)="volverAlMenu()" class="btn btn-circle btn-outline mr-4">
          <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24">
            <path fill="currentColor" d="M20 11H7.83l5.59-5.59L12 4l-8 8 8 8 1.41-1.41L7.83 13H20z"/>
          </svg>
        </button>
        <div>
          <h1 class="text-4xl font-bold text-slate-800">Registrar Nuevo Usuario</h1>
          <p class="text-slate-600 mt-1">Complete los datos del cliente, vehículo y seleccione un espacio</p>
        </div>
      </div>

      <app-form-nuevo-cliente
        [formData]="nuevoCliente()"
        [tiposVehiculo]="tiposVehiculo()"
        [espacioSeleccionado]="espacioSeleccionado()"
        [isLoading]="isLoading()"
        (espacioSeleccionClick)="abrirModalEspacios()"
        (cancelar)="volverAlMenu()"
        (registrar)="registrarNuevoCliente()">
      </app-form-nuevo-cliente>
    </div>
  }

  <!-- ==================== VISTA: ASIGNAR ESPACIO ==================== -->
  @if (vistaActiva() === 'asignar-espacio') {
    <div class="max-w-5xl mx-auto">
      <!-- Header -->
      <div class="flex items-center mb-8">
        <button (click)="volverAlMenu()" class="btn btn-circle btn-outline mr-4">
          <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24">
            <path fill="currentColor" d="M20 11H7.83l5.59-5.59L12 4l-8 8 8 8 1.41-1.41L7.83 13H20z"/>
          </svg>
        </button>
        <div>
          <h1 class="text-4xl font-bold text-slate-800">Asignar Espacio</h1>
          <p class="text-slate-600 mt-1">Seleccione un cliente y vehículo para asignar espacio</p>
        </div>
      </div>

      <app-form-asignar-espacio
        [formData]="asignarEspacio()"
        [clientesConVehiculos]="clientesConVehiculos()"
        [espacioSeleccionado]="espacioSeleccionado()"
        [clienteExpandido]="clienteExpandido()"
        [isLoading]="isLoading()"
        (toggleCliente)="toggleCliente($event)"
        (espacioSeleccionClick)="abrirModalEspacios()"
        (cancelar)="volverAlMenu()"
        (confirmar)="confirmarAsignacion()">
      </app-form-asignar-espacio>
    </div>
  }

  <!-- ==================== VISTA: DESOCUPAR ESPACIO ==================== -->
  @if (vistaActiva() === 'desocupar-espacio') {
    <div class="max-w-6xl mx-auto">
      <!-- Header -->
      <div class="flex items-center mb-8">
        <button (click)="volverAlMenu()" class="btn btn-circle btn-outline mr-4">
          <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24">
            <path fill="currentColor" d="M20 11H7.83l5.59-5.59L12 4l-8 8 8 8 1.41-1.41L7.83 13H20z"/>
          </svg>
        </button>
        <div>
          <h1 class="text-4xl font-bold text-slate-800">Desocupar Espacio</h1>
          <p class="text-slate-600 mt-1">Seleccione un vehículo ocupado y registre el pago</p>
        </div>
      </div>

      <app-form-desocupar-espacio
        [formData]="desocuparEspacio()"
        [vehiculosOcupados]="vehiculosOcupados()"
        [tiposTarifa]="tiposTarifa()"
        [isLoading]="isLoading()"
        (seleccionarVehiculo)="seleccionarVehiculoOcupado($event)"
        (cancelar)="volverAlMenu()"
        (confirmar)="confirmarDesocupacion()">
      </app-form-desocupar-espacio>
    </div>
  }

  <!-- ==================== MODAL: SELECCIÓN DE ESPACIOS ==================== -->
  @if (showEspaciosModal()) {
    <div class="modal modal-open">
      <div class="modal-box max-w-3xl">
        <h3 class="font-bold text-2xl mb-4">Espacios Disponibles</h3>
        
        <app-espacios-grid
          [espacios]="espaciosDisponibles()"
          [mostrarTodos]="false"
          [gridCols]="4"
          (espacioSeleccionado)="seleccionarEspacio($event)">
        </app-espacios-grid>

        <div class="modal-action">
          <button (click)="cerrarModalEspacios()" class="btn">Cerrar</button>
        </div>
      </div>
      <div class="modal-backdrop" (click)="cerrarModalEspacios()"></div>
    </div>
  }

</section>
